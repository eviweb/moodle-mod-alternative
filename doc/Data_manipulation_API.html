<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>Data manipulation API - MoodleDocs</title>
<meta name="generator" content="MediaWiki 1.17.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/dev/opensearch_desc.php" title="MoodleDocs dev (Development)" />
<link rel="EditURI" type="application/rsd+xml" href="http://docs.moodle.org/dev/api.php?action=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="/dev/index.php?title=Data_manipulation_API&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://docs.moodle.org/en/License" />
<link rel="alternate" type="application/atom+xml" title="MoodleDocs Atom feed" href="/dev/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="/dev/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared&amp;only=styles&amp;skin=moodledocsnew&amp;*" />
<link rel="stylesheet" href="/dev/skins/monobook/main.css?301" media="screen" />
<link rel="stylesheet" href="/dev/skins/moodledocsnew/main.css?301" media="screen" />
<link rel="stylesheet" href="/dev/skins/moodledocsnew/menu/moodlemenu.css?301" media="screen" />
<link rel="stylesheet" href="/dev/skins/moodledocsnew/menu/menuprint.css?301" media="print" />
<link rel="stylesheet" href="/dev/skins/moodledocsnew/customisation.dev.css?301" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/dev/skins/monobook/IE50Fixes.css?301" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/dev/skins/monobook/IE55Fixes.css?301" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/dev/skins/monobook/IE60Fixes.css?301" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/dev/skins/monobook/IE70Fixes.css?301" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/dev/skins/moodledocsnew/fixes.IE70.css?301" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/dev/skins/moodledocsnew/fixes.IE60.css?301" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/dev/skins/moodledocsnew/fixes.IE55.css?301" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
</head>
<body class="mediawiki ltr ns-0 ns-subject page-Data_manipulation_API skin-moodledocsnew">
<div id="page">
<!-- header start -->
<div id="moodlelogo"><a href="http://moodle.org/"><img class='logo' src='/dev/skins/moodledocsnew/images/moodle-logo.gif'\ alt='moodlelogo' title='moodle.org' /></a></div>
<!-- header end -->


<!-- menu start -->
<div id="moodlemenu" class="clearfix"><div id="moodle-custommenu"><div id="custom-menu-1" class="moodle-custom-menu mcm cssonly"><div class="mcm-content"><ul class="mcm-container with-children"><li class="mcm-item with-children"><a class="mcm-link with-children" title="An overview about Moodle" href="http://moodle.org/about/">About</a><span class="mcm-link-dropdown">&#x25BC;</span><div id="mcm-submenu-1" class="mcm-submenu"><div class="mcm-content"><ul class="mcm-container with-children"><li class="mcm-item without-children"><a class="mcm-link without-children" title="What is Moodle?" href="http://docs.moodle.org/en/About_Moodle">What is Moodle?</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle.org: Moodle Statistics" href="http://moodle.org/stats/">Moodle.org: Moodle Statistics</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Demonstration site" href="http://demo.moodle.org/">Demonstration site</a></li></ul></div></div></li><li class="mcm-item with-children"><a class="mcm-link with-children" title="An overview of current Moodle news" href="http://moodle.org/news/">News</a><span class="mcm-link-dropdown">&#x25BC;</span><div id="mcm-submenu-2" class="mcm-submenu"><div class="mcm-content"><ul class="mcm-container with-children"><li class="mcm-item without-children"><a class="mcm-link without-children" title="Official news about Moodle" href="http://moodle.org/news/">Recent news</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Important information about security issues" href="http://moodle.org/security/">Security news</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Aggregated blogs from Moodle developers" href="http://planet.moodle.org/">Planet Moodle</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle-related publications from around the world" href="http://moodle.org/mod/data/view.php?d=19">Moodle Buzz</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle-related events in the future" href="http://moodle.org/calendar/view.php">Calendar</a></li></ul></div></div></li><li class="mcm-item with-children"><a class="mcm-link with-children" title="An overview of Moodle support options" href="http://moodle.org/support/">Support</a><span class="mcm-link-dropdown">&#x25BC;</span><div id="mcm-submenu-3" class="mcm-submenu"><div class="mcm-content"><ul class="mcm-container with-children"><li class="mcm-item without-children"><a class="mcm-link without-children" title="Documentation" href="http://docs.moodle.org/?lang=en">Documentation</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Forums" href="http://moodle.org/forums/">Forums</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Books and manuals" href="http://moodle.org/mod/data/view.php?id=7246">Books and manuals</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Commercial services" href="http://moodle.org/support/commercial/">Commercial services</a></li></ul></div></div></li><li class="mcm-item with-children"><a class="mcm-link with-children" title="An overview of the Moodle community" href="http://moodle.org/community/">Community</a><span class="mcm-link-dropdown">&#x25BC;</span><div id="mcm-submenu-4" class="mcm-submenu"><div class="mcm-content"><ul class="mcm-container with-children"><li class="mcm-item without-children"><a class="mcm-link without-children" title="Forums" href="http://moodle.org/forums/">Forums</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Events" href="http://moodle.org/events/">Events</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Registered sites" href="http://moodle.org/sites/">Registered sites</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Connected sites" href="http://moodle.org/network/">Connected sites</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle Jobs" href="http://moodle.org/mod/data/view.php?id=7232">Moodle Jobs</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Recent participants" href="http://moodle.org/userpics/">Recent participants</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Donations" href="http://moodle.org/donations/">Donations</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle Shop" href="http://www.cafepress.com/moodle/">Moodle Shop</a></li></ul></div></div></li><li class="mcm-item with-children"><a class="mcm-link with-children" title="An overview of Moodle development" href="http://moodle.org/development/">Development</a><span class="mcm-link-dropdown">&#x25BC;</span><div id="mcm-submenu-5" class="mcm-submenu"><div class="mcm-content"><ul class="mcm-container with-children"><li class="mcm-item without-children"><a class="mcm-link without-children" title="Developers" href="http://moodle.org/dev/">Developers</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Developer documentation" href="http://docs.moodle.org/en/Development">Developer documentation</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle Tracker" href="http://tracker.moodle.org/">Moodle Tracker</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Open source code" href="http://git.moodle.org/">Open source code</a></li></ul></div></div></li><li class="mcm-item with-children"><a class="mcm-link with-children" title="An overview of Moodle downloads" href="http://moodle.org/downloads/">Downloads</a><span class="mcm-link-dropdown">&#x25BC;</span><div id="mcm-submenu-6" class="mcm-submenu"><div class="mcm-content"><ul class="mcm-container with-children"><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle standard packages" href="http://download.moodle.org/">Moodle standard packages</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Plugins" href="http://moodle.org/plugins/">Plugins</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Language packs" href="http://download.moodle.org/langpack/">Language packs</a></li><li class="mcm-item without-children"><a class="mcm-link without-children" title="Moodle logos" href="http://moodle.org/logo/">Moodle logos</a></li></ul></div></div></li></ul></div></div></div><form id="global-search" method="get" action="http://moodle.org/public/search"><div><input type="hidden" name="cx" value="017878793330196534763:-0qxztjngoy" /><input type="hidden" name="cof" value="FORID:9" /><input type="hidden" name="ie" value="UTF-8" /><input class="input-text" type="text" name="q" size="15" maxlength="255"/><input class="input-submit" type="submit" name="sa" value="Search moodle.org"/></div></form></div>
<!-- menu end -->


<!-- navbar start -->
<div id="moodlenavbar" class="navbar clearfix" dir="LTR"><div class="breadcrumb"><h2 class="accesshide">You are here</h2></div></div>
<!-- navbar end -->

<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">Data manipulation API</h1>
	<div id="bodyContent">
		<div id="siteSub">From MoodleDocs</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
		<!-- start content -->
<p><span class="small-info-right"><span class="text-small">Moodle </span><span class="text-big new">2.0</span></span>
</p><p>This page describes the functions available to access data in the Moodle database. You should <b>exclusively</b> use these functions in order to retrieve or modify database content because these functions provide a high level of abstraction and guarantee that your database manipulation will work against different RDBMSes.
</p><p>Where possible, tricks and examples will be documented here in order to make developers' lives a bit easier. Of course, feel free to clarify, complete and add more information to  this documentation. It will be welcome, absolutely!
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Main_info"><span class="tocnumber">1</span> <span class="toctext">Main info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#The_functions"><span class="tocnumber">2</span> <span class="toctext">The functions</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Getting_a_single_record"><span class="tocnumber">2.1</span> <span class="toctext">Getting a single record</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Getting_an_hashed_array_of_records"><span class="tocnumber">2.2</span> <span class="toctext">Getting an hashed array of records</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Seeing_how_many_records_match_a_given_criteria"><span class="tocnumber">2.3</span> <span class="toctext">Seeing how many records match a given criteria</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Seeing_if_one_record_exists"><span class="tocnumber">2.4</span> <span class="toctext">Seeing if one record exists</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Examples"><span class="tocnumber">2.4.1</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-4 tocsection-8"><a href="#moodle_database::get_records.28.29"><span class="tocnumber">2.4.1.1</span> <span class="toctext">moodle_database::get_records()</span></a></li>
<li class="toclevel-4 tocsection-9"><a href="#moodle_database::get_records_select.28.29"><span class="tocnumber">2.4.1.2</span> <span class="toctext">moodle_database::get_records_select()</span></a></li>
<li class="toclevel-4 tocsection-10"><a href="#moodle_database::get_records_sql.28.29"><span class="tocnumber">2.4.1.3</span> <span class="toctext">moodle_database::get_records_sql()</span></a></li>
<li class="toclevel-4 tocsection-11"><a href="#moodle_database::get_records_list.28.29"><span class="tocnumber">2.4.1.4</span> <span class="toctext">moodle_database::get_records_list()</span></a></li>
<li class="toclevel-4 tocsection-12"><a href="#moodle_database::get_records_menu.28.29"><span class="tocnumber">2.4.1.5</span> <span class="toctext">moodle_database::get_records_menu()</span></a></li>
<li class="toclevel-4 tocsection-13"><a href="#moodle_database::get_records_select_menu.28.29"><span class="tocnumber">2.4.1.6</span> <span class="toctext">moodle_database::get_records_select_menu()</span></a></li>
<li class="toclevel-4 tocsection-14"><a href="#moodle_database::get_records_sql_menu.28.29"><span class="tocnumber">2.4.1.7</span> <span class="toctext">moodle_database::get_records_sql_menu()</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Getting_a_particular_field_value_from_one_record"><span class="tocnumber">2.5</span> <span class="toctext">Getting a particular field value from one record</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Getting_a_particular_field_value_from_various_records"><span class="tocnumber">2.6</span> <span class="toctext">Getting a particular field value from various records</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Setting_a_particular_field_in_the_database"><span class="tocnumber">2.7</span> <span class="toctext">Setting a particular field in the database</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Deleting_Records"><span class="tocnumber">2.8</span> <span class="toctext">Deleting Records</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Inserting_Records"><span class="tocnumber">2.9</span> <span class="toctext">Inserting Records</span></a>
<ul>
<li class="toclevel-3 tocsection-20"><a href="#Example.28s.29"><span class="tocnumber">2.9.1</span> <span class="toctext">Example(s)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21"><a href="#Updating_Records"><span class="tocnumber">2.10</span> <span class="toctext">Updating Records</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Using_Recordsets"><span class="tocnumber">2.11</span> <span class="toctext">Using Recordsets</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Delegated_transactions"><span class="tocnumber">2.12</span> <span class="toctext">Delegated transactions</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#Example.28s.29_2"><span class="tocnumber">2.12.1</span> <span class="toctext">Example(s)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="#Helper_Functions"><span class="tocnumber">2.13</span> <span class="toctext">Helper Functions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26"><a href="#See_also"><span class="tocnumber">3</span> <span class="toctext">See also</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Main_info"> Main info </span></h2>
<p><b>Important note:</b> All the functions shown on this page are for use in <b>Moodle 2.0 upwards</b>, where we changed the <a href="/dev/DB_layer_2.0" title="DB layer 2.0">DB layer</a> to support some new features. If you need information for previous Moodle version, take a look to the <a href="/dev/DML_functions_-_pre_2.0" title="DML functions - pre 2.0">DML functions - pre 2.0</a> page. For a detailed reference of changes, see the <a href="/dev/DB_layer_2.0_migration_docs" title="DB layer 2.0 migration docs">migration docs</a>.
</p>
<ul><li> All the function calls on this page are public methods of the $DB global object, so you'll need to "import" it within your functions (not needed in global scripts) with one simple:
</li></ul>
<pre class="php"><span style="color: #990000;">global</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">;</span></pre>
<ul><li> The $DB global object is an instance of the moodle_database class, which is defined in <a href="http://cvs.moodle.org/moodle/lib/dml/moodle_database.php?view=markup" class="external text" rel="nofollow">moodle_database.php</a>
</li><li> All the $table parameters in the functions are meant to be the table name <i>without</i> prefixes.
</li></ul>
<pre class="php"><span style="color: #000033;">$user</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'user'</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'id'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<ul><li> When using the xxx_sql() functions, table names must be enclosed between curly braces.
</li></ul>
<pre class="php"><span style="color: #000033;">$user</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record_sql</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'SELECT * FROM {user} WHERE id =&#160;?'</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<ul><li> All the $conditions parameters in the functions are arrays of fieldname=&gt;fieldvalue elements.
</li></ul>
<pre class="php"><span style="color: #000033;">$user</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'user'</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'firstname'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'Martin'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'lastname'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'Dougiamas'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<ul><li> All the $params parameters in the functions are arrays of values used to fill placeholders in SQL statements. Both the question mark and named placeholders can be used. Note that named params <b>must be unique</b> even if the value passed is the same.
</li></ul>
<pre class="php"><span style="color: #666666; font-style: italic;">/// Question mark placeholders:</span><br />   <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record_sql</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'SELECT * FROM {user} WHERE firstname =&#160;? AND lastname =&#160;?'</span><span style="color: #339933;">,</span> <br />                       <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Martin'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Dougiamas'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #666666; font-style: italic;">/// Named placeholders:</span><br />   <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record_sql</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'SELECT * FROM {user} WHERE firstname =&#160;:firstname AND lastname =&#160;:lastname'</span><span style="color: #339933;">,</span><br />                       <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'firstname'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'Martin'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'lastname'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'Dougiamas'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<h2> <span class="mw-headline" id="The_functions"> The functions </span></h2>
<h3> <span class="mw-headline" id="Getting_a_single_record">Getting a single record</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$strictness</span><span style="color: #339933;">=</span>IGNORE_MISSING<span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get a single database record as an object where all the given conditions met.</span><br />  <span style="color: #666666; font-style: italic;">/// @param int $strictness IGNORE_MISSING means compatible mode, false returned if record not found, debug message if more found;</span><br />  <span style="color: #666666; font-style: italic;">///                        IGNORE_MULTIPLE means return first, ignore multiple records found(not recommended);</span><br />  <span style="color: #666666; font-style: italic;">///                        MUST_EXIST means throw exception if no record or multiple records found</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$strictness</span><span style="color: #339933;">=</span>IGNORE_MISSING<span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get a single database record as an object which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_record_sql</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$strictness</span><span style="color: #339933;">=</span>IGNORE_MISSING<span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get a single database record as an object using a SQL statement.</span></pre>
<h3> <span class="mw-headline" id="Getting_an_hashed_array_of_records">Getting an hashed array of records</span></h3>
<p>Each of the following methods return an array of objects. The array is indexed by the first column of the fields returned by the query. Thus to assure consistent data, it appears to be best practice to ensure that your query include an "id column" as the first field. (When developing custom tables, be sure to make id your first column for this reason!)
</p>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as an array of objects where all the given conditions met.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as an array of objects which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_sql</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as an array of objects using a SQL statement.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_list</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$field</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$values</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as an array of objects where one field match one list of values.</span></pre>
<p>===Getting an 
The following methods return data as key/value pairs in an associative array.
</p>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get the first two columns from a number of records as an associative array where all the given conditions met.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_select_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get the first two columns from a number of records as an associative array which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_sql_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get the first two columns from a number of records as an associative array using a SQL statement.</span></pre>
<h3> <span class="mw-headline" id="Seeing_how_many_records_match_a_given_criteria">Seeing how many records match a given criteria</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">count_records</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Count the records in a table where all the given conditions met.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">count_records_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$countitem</span><span style="color: #339933;">=</span><span style="color: #0000ff;">&quot;COUNT('x')&quot;</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Count the records in a table which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">count_records_sql</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get the result of a SQL SELECT COUNT(...) query.</span></pre>
<h3> <span class="mw-headline" id="Seeing_if_one_record_exists">Seeing if one record exists</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">record_exists</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Test whether a record exists in a table where all the given conditions met.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">record_exists_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Test whether any records exists in a table which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">record_exists_sql</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Test whether a SQL SELECT statement returns any records.</span></pre>
<h4> <span class="mw-headline" id="Examples">Examples</span></h4>
<h5> <span class="mw-headline" id="moodle_database::get_records.28.29">moodle_database::get_records()</span></h5>
<p>Get a number of records as an array of objects where all the given conditions met.
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">///Get all records where foo = bar</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'foo'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'bar'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #666666; font-style: italic;">///Get all records where foo = bar and jon = doe</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'foo'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'bar AND'</span> <span style="color: #339933;">,</span> <span style="color: #0000ff;">'jon'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'doe'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #666666; font-style: italic;">///Get all records where foo = bar, but only return the fields foo,bar,jon,doe</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'foo'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'bar'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'foo,bar,jon,doe'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br /><span style="color: #666666; font-style: italic;">///The previous example would cause data issues unless the 'foo' field happens to have unique values.</span></pre>
<h5> <span class="mw-headline" id="moodle_database::get_records_select.28.29">moodle_database::get_records_select()</span></h5>
<p>Get a number of records as an array of objects which match a particular WHERE clause.
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">///Get all records where jon = 'doe' and bob is not = 'tom'</span><br /><span style="color: #666666; font-style: italic;">///The 'select' parameter is (if not empty) is dropped directly into the WHERE clause without alteration.</span><br /><span style="color: #000033;">$table</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'foo'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$select</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'jon = '</span>doe<span style="color: #0000ff;">' AND bob&#160;!= &quot;tom&quot; '</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//is put into the where clause</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #000033;">$select</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<h5> <span class="mw-headline" id="moodle_database::get_records_sql.28.29">moodle_database::get_records_sql()</span></h5>
<p>Get a number of records as an array of objects using a SQL statement. Defined as an abstract function in moodle_database, this method is implemented per database type.
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">///Get all records from 'table' where foo = bar</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_sql</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'SELECT * FROM table WHERE foo =&#160;?'</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'bar'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #666666; font-style: italic;">///Get all records from 'table' where foo = 'bar' and bob = 'tom'</span><br /><span style="color: #666666; font-style: italic;">///This is somewhat similar to how Drupal makes its queries</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_sql</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'SELECT * FROM table WHERE foo =&#160;? AND bob =&#160;?'</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">'bar'</span> <span style="color: #339933;">,</span> <span style="color: #0000ff;">'tom'</span> <span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<h5> <span class="mw-headline" id="moodle_database::get_records_list.28.29">moodle_database::get_records_list()</span></h5>
<p>Get a number of records as an array of objects where one field match one list of values.
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">///Get all records where the values('bar', 'elephant', 'moodle') are found in the field 'foo'</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_list</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'foo'</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">'bar'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'elephant'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'moodle'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #666666; font-style: italic;">///Get all records where the values('bar', 'elephant', 'moodle') are found in the field 'foo'</span><br /><span style="color: #666666; font-style: italic;">///Only returning the fields 'id', 'test' and 'taco'</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_list</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'foo'</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">'bar'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'elephant'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'moodle'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'id,test,taco'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<h5> <span class="mw-headline" id="moodle_database::get_records_menu.28.29">moodle_database::get_records_menu()</span></h5>
<p>Get the first two columns from a number of records as an associative array where all the given conditions met. 
You can choose the two fields or leave the parameter blank and the method will return the first two columns of the table.
Returns an associative array. 
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">///Get all records from table 'foo' where column 'foo' is equal to the value 'bar'</span><br /><span style="color: #000033;">$table</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'foo'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">///name of table</span><br /><span style="color: #000033;">$conditions</span> <span style="color: #339933;">=</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'foo'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'bar'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">///the name of the field (key) and the desired value</span><br />&#160;<br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #000033;">$conditions</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #666666; font-style: italic;">///Get all records from table 'foo' where column 'foo' is equal to the value 'bar'</span><br /><span style="color: #666666; font-style: italic;">///Returning the values from the columns 'id' and 'tacos'</span><br /><span style="color: #000033;">$table</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'foo'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">///name of table</span><br /><span style="color: #000033;">$conditions</span> <span style="color: #339933;">=</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'foo'</span><span style="color: #339933;">=&gt;</span><span style="color: #0000ff;">'bar'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">///the name of the field (key) and the desired value</span><br /><span style="color: #000033;">$fields</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'id, tacos'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">///list of fields to return</span><br />&#160;<br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #000033;">$conditions</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<p>The result of this last example will look something like:
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">/// The value of the id field  is 909 and the value of the 'tacos' column is 6</span><br /><span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">909</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">6</span> <span style="color: #009900;">&#125;</span></pre>
<h5> <span class="mw-headline" id="moodle_database::get_records_select_menu.28.29">moodle_database::get_records_select_menu()</span></h5>
<p>Get the first two columns from a number of records as an associative array which match a particular WHERE clause.
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">///Get all records where jon = 'doe' and bob is not = 'tom'</span><br /><span style="color: #666666; font-style: italic;">///The 'select' parameter is (if not empty) is dropped directly into the WHERE clause without alteration.</span><br /><span style="color: #000033;">$table</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'foo'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$select</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'jon = &quot;doe&quot; AND bob&#160;!= &quot;tom&quot; '</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//is put into the where clause</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_select_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #000033;">$select</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #000033;">$table</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'foo'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$select</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'jon = &quot;doe&quot; AND bob&#160;!= &quot;tom&quot; '</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//is put into the where clause</span><br /><span style="color: #000033;">$fields</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'id, tacos'</span><span style="color: #339933;">;</span><span style="color: #666666; font-style: italic;">//return these fields</span><br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_select_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span><span style="color: #000033;">$select</span><span style="color: #339933;">,</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span><span style="color: #000033;">$fields</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<p>The result of this last example will look something like:
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">/// The value of the id field  is 909 and the value of the 'tacos' column is 6</span><br /><span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">909</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">6</span> <span style="color: #009900;">&#125;</span></pre>
<h5> <span class="mw-headline" id="moodle_database::get_records_sql_menu.28.29">moodle_database::get_records_sql_menu()</span></h5>
<p>Get the first two columns from a number of records as an associative array using a SQL statement.
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">///Get all records from table foo where bar = 6</span><br /><span style="color: #000033;">$sql</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'SELECT * FROM foo WHERE bar =&#160;?'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$params</span> <span style="color: #339933;">=</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_sql_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span><span style="color: #000033;">$params</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #666666; font-style: italic;">///Get all records from table foo where bar = 6</span><br /><span style="color: #000033;">$sql</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'SELECT id,tacos FROM foo WHERE bar =&#160;?'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$params</span> <span style="color: #339933;">=</span> <span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br /><span style="color: #000033;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_records_sql_menu</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span><span style="color: #000033;">$params</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<p>The result of this last example will look something like:
</p>
<pre class="php"><span style="color: #666666; font-style: italic;">/// The value of the id field  is 909 and the value of the 'tacos' column is 6</span><br /><span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">909</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">6</span> <span style="color: #009900;">&#125;</span></pre>
<h3> <span class="mw-headline" id="Getting_a_particular_field_value_from_one_record">Getting a particular field value from one record</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_field</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$return</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">,</span> <span style="color: #000033;">$strictness</span><span style="color: #339933;">=</span>IGNORE_MISSING<span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get a single field value from a table record where all the given conditions met.</span><br />  <span style="color: #666666; font-style: italic;">/// @param int $strictness</span><br />  <span style="color: #666666; font-style: italic;">///   IGNORE_MISSING means compatible mode, false returned if record not found, debug message if more found;</span><br />  <span style="color: #666666; font-style: italic;">///   IGNORE_MULTIPLE means return first, ignore multiple records found(not recommended);</span><br />  <span style="color: #666666; font-style: italic;">///   MUST_EXIST means throw exception if no record or multiple records found</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_field_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$return</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$strictness</span><span style="color: #339933;">=</span>IGNORE_MISSING<span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get a single field value from a table record which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_field_sql</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$strictness</span><span style="color: #339933;">=</span>IGNORE_MISSING<span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Get a single field value (first field) using a SQL statement.</span></pre>
<h3> <span class="mw-headline" id="Getting_a_particular_field_value_from_various_records">Getting a particular field value from various records</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_fieldset_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$return</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Selects records and return values of chosen field as an array which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_fieldset_sql</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Selects records and return values (first field) as an array using a SQL statement.</span></pre>
<h3> <span class="mw-headline" id="Setting_a_particular_field_in_the_database">Setting a particular field in the database</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">set_field</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$newfield</span><span style="color: #339933;">,</span> <span style="color: #000033;">$newvalue</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Set a single field in every table record where all the given conditions met.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">set_field_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$newfield</span><span style="color: #339933;">,</span> <span style="color: #000033;">$newvalue</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Set a single field in every table record which match a particular WHERE clause.</span></pre>
<h3> <span class="mw-headline" id="Deleting_Records">Deleting Records</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">delete_records</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Delete the records from a table where all the given conditions met.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">delete_records_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Delete one or more records from a table which match a particular WHERE clause.</span></pre>
<h3> <span class="mw-headline" id="Inserting_Records">Inserting Records</span></h3>
<p>The method to insert records is called aptly enough, insert_record(). The method accepts 4 parameters, but the fourth, "bulk", in most implementations is unused.
</p>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">insert_record</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$dataobject</span><span style="color: #339933;">,</span> <span style="color: #000033;">$returnid</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">,</span> <span style="color: #000033;">$bulk</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Insert a record into a table and return the &quot;id&quot; field if required.</span></pre>
<h4> <span class="mw-headline" id="Example.28s.29">Example(s)</span></h4>
<pre class="php"><span style="color: #000033;">$record</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> stdClass<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$record</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">name</span>         <span style="color: #339933;">=</span> <span style="color: #0000ff;">'overview'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$record</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">displayorder</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'10000'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">insert_record</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'quiz_report'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$record</span><span style="color: #339933;">,</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<pre class="php"><span style="color: #000033;">$record</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> stdClass<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$record</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">name</span>         <span style="color: #339933;">=</span> <span style="color: #0000ff;">'overview'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$record</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">displayorder</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'10000'</span><span style="color: #339933;">;</span><br /><span style="color: #000033;">$lastinsertid</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">insert_record</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'quiz_report'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$record</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<h3> <span class="mw-headline" id="Updating_Records">Updating Records</span></h3>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">update_record</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$dataobject</span><span style="color: #339933;">,</span> <span style="color: #000033;">$bulk</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Update a record in a table.</span><br />  <span style="color: #666666; font-style: italic;">/// </span><br />  <span style="color: #666666; font-style: italic;">/// $dataobject is an object containing needed data</span><br />  <span style="color: #666666; font-style: italic;">/// Relies on $dataobject having a variable &quot;id&quot; to</span><br />  <span style="color: #666666; font-style: italic;">/// specify the record to update</span><br />  <span style="color: #666666; font-style: italic;">/// </span><br />  <span style="color: #666666; font-style: italic;">/// @param string $table The database table to be checked against.</span><br />  <span style="color: #666666; font-style: italic;">/// @param object $dataobject An object with contents equal to fieldname=&gt;fieldvalue.</span><br />  <span style="color: #666666; font-style: italic;">///        Must have an entry for 'id' to map to the table specified.</span><br />  <span style="color: #666666; font-style: italic;">/// @param bool $bulk true means repeated updates expected</span><br />  <span style="color: #666666; font-style: italic;">/// @return bool true</span><br />  <span style="color: #666666; font-style: italic;">/// @throws dml_exception if an error occurs.</span></pre>
<h3> <span class="mw-headline" id="Using_Recordsets">Using Recordsets</span></h3>
<p>Where the number of records to be retrieved from DB is high, the <b>get_records_xxx()</b> functions above are far from optimal, because they load all the records in memory at the same time. Under those circumstances, it is highly recommended to use these <b>get_recordset_xxx()</b> functions instead, which use one nice mechanism to iterate over all the target records and save a lot of memory.
</p><p>Only one thing is <b>absolutely important</b>: Don't forget to close the recordsets after using them! (This will free up a lot of resources in the RDBMS).
</p><p>Here is the general way to iterate over records using the <b>get_recordset_xxx()</b> functions:
</p>
<pre class="php"><span style="color: #000033;">$rs</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_recordset</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">....</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br /><span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000033;">$rs</span> <span style="color: #b1b100;">as</span> <span style="color: #000033;">$record</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />    <span style="color: #666666; font-style: italic;">// Do whatever you want with this record</span><br /><span style="color: #009900;">&#125;</span><br /><span style="color: #000033;">$rs</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">close</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// Don't forget to close the recordset!</span></pre>
<p>And this is the list of available functions (100% paired with the get_records_xxx() above):
</p>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_recordset</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$conditions</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as a moodle_recordset where all the given conditions met.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_recordset_select</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$select</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as a moodle_recordset which match a particular WHERE clause.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_recordset_sql</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$sql</span><span style="color: #339933;">,</span> <span style="color: #990000;">array</span> <span style="color: #000033;">$params</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as a moodle_recordset using a SQL statement.</span><br />&#160;<br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">get_recordset_list</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$table</span><span style="color: #339933;">,</span> <span style="color: #000033;">$field</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$values</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$sort</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fields</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'*'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitfrom</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #000033;">$limitnum</span><span style="color: #339933;">=</span><span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Get a number of records as a moodle_recordset where one field matches one list of values.</span></pre>
<p>Unlike get_record functions, you cannot use <tt>$rs == true</tt> or <tt>!empty($rs)</tt> to determine if any records were found.
Recordsets implement the standard PHP Iterator interface (<a href="http://uk.php.net/manual/en/class.iterator.php" class="external free" rel="nofollow">http://uk.php.net/manual/en/class.iterator.php</a>)
</p><p>So,
</p>
<pre class="php"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000033;">$rs</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">valid</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />    <span style="color: #666666; font-style: italic;">// The recordset contains records.</span><br /><span style="color: #009900;">&#125;</span></pre>
<h3> <span class="mw-headline" id="Delegated_transactions">Delegated transactions</span></h3>
<ul><li> Please note some databases do not support transactions (such as the MyISAM MySQL database engine), however all server administrators are strongly encouraged to migrate to databases that support transactions (such as the InnoDB MySQL database engine).
</li><li> Previous versions supported only one level of transaction. Since Moodle 2.0, the DML layer emulates delegated transactions that allow nesting of transactions.
</li><li> Transactions should not be used much in Moodle core; they are intended for various plugins such as web services, enrol and auth plugins.
</li><li> Some subsystems (such as messaging) do not support transactions because is it is not possible to rollback in external systems.
</li></ul>
<p>A transaction is started by:
</p>
<pre class="php"><span style="color: #000033;">$transaction</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">start_delegated_transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<p>and finished by:
</p>
<pre class="php"><span style="color: #000033;">$transaction</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">allow_commit</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<p>Usually a transaction is rolled back when an exception is thrown. <code>$transaction->rollback($ex);</code> must be used very carefully because it might break compatibility with databases that do not support transactions. Transactions cannot be used as part of expected code flow; they can be used only as an emergency protection of data consistency.
</p><p>See more details in <a href="/dev/DB_layer_2.0_delegated_transactions" title="DB layer 2.0 delegated transactions">DB layer 2.0 delegated transactions</a> or <a href="http://tracker.moodle.org/browse/MDL-20625" class="external text" rel="nofollow">MDL-20625</a>.
</p>
<h4> <span class="mw-headline" id="Example.28s.29_2">Example(s)</span></h4>
<pre class="php"><span style="color: #990000;">global</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">;</span><br />try <span style="color: #009900;">&#123;</span><br />     <span style="color: #000033;">$transaction</span> <span style="color: #339933;">=</span> <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">start_delegated_transaction</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />     <span style="color: #666666; font-style: italic;">// Insert a record</span><br />     <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">insert</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'foo'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$object</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />     <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">insert</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'bar'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$otherobject</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />&#160;<br />     <span style="color: #666666; font-style: italic;">// Assuming the both inserts work, we get to the following line.</span><br />     <span style="color: #000033;">$transaction</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">allow_commit</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br /><span style="color: #009900;">&#125;</span> catch<span style="color: #009900;">&#40;</span>Exception <span style="color: #000033;">$e</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />     <span style="color: #000033;">$transaction</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">rollback</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$e</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br /><span style="color: #009900;">&#125;</span></pre>
<h3> <span class="mw-headline" id="Helper_Functions">Helper Functions</span></h3>
<p>In order have real cross-db compatibility, there are some helper functions used to build SQL fragments based on the DB Moodle is running. Using them we'll avoid conditional queries here and there and have those "incompatibilities" fixed once and for ever.
</p>
<pre class="php">o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_bitand</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$int1</span><span style="color: #339933;">,</span> <span style="color: #000033;">$int2</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used in order to perform one bitwise AND </span><br />  <span style="color: #666666; font-style: italic;">/// operation between 2 integers.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_bitnot</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$int1</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used in order to perform one bitwise NOT </span><br />  <span style="color: #666666; font-style: italic;">/// operation with 1 integer.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_bitor</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$int1</span><span style="color: #339933;">,</span> <span style="color: #000033;">$int2</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used in order to perform one bitwise OR </span><br />  <span style="color: #666666; font-style: italic;">/// operation between 2 integers.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_bitxor</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$int1</span><span style="color: #339933;">,</span> <span style="color: #000033;">$int2</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used in order to perform one bitwise XOR </span><br />  <span style="color: #666666; font-style: italic;">/// operation between 2 integers.</span><br />&#160;<br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_null_from_clause</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the FROM clause required by some DBs in all SELECT statements.</span><br />&#160;<br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_ceil</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$fieldname</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the correct CEIL expression applied to fieldname.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_like</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$fieldname</span><span style="color: #339933;">,</span> <span style="color: #000033;">$param</span><span style="color: #339933;">,</span> <span style="color: #000033;">$casesensitive</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">,</span> <span style="color: #000033;">$accentsensitive</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">,</span> <span style="color: #000033;">$notlike</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #339933;">,</span> <span style="color: #000033;">$escapechar</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">' <span style="color: #000099; font-weight: bold;">\\</span> '</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the proper SQL to do LIKE.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_length</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$fieldname</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used to calculate the length in characters of one expression.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_modulo</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$int1</span><span style="color: #339933;">,</span> <span style="color: #000033;">$int2</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used in order to calculate module - remainder after division</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_position</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$needle</span><span style="color: #339933;">,</span> <span style="color: #000033;">$haystack</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL for returning searching one string for the location of another.</span><br />  <span style="color: #666666; font-style: italic;">/// Note: If using placeholders BOTH in $needle and $haystack, they MUST be named placeholders.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_substr</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$expr</span><span style="color: #339933;">,</span> <span style="color: #000033;">$start</span><span style="color: #339933;">,</span> <span style="color: #000033;">$length</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the proper substr() SQL text used to extract substrings from DB.</span><br />  <span style="color: #666666; font-style: italic;">/// Note: This fuction has changed in Moodle 2.0 and now at least 2 params are mandatory.</span><br />  <span style="color: #666666; font-style: italic;">/// Note: Now it returns the whole SQL text to be used instead of only the function name.</span><br />&#160;<br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_cast_char2int</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$fieldname</span><span style="color: #339933;">,</span> <span style="color: #000033;">$text</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL to be used in order to CAST one CHAR column to INTEGER.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_cast_char2real</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$fieldname</span><span style="color: #339933;">,</span> <span style="color: #000033;">$text</span><span style="color: #339933;">=</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL to be used in order to CAST one CHAR column to REAL number.</span><br />&#160;<br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_compare_text</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$fieldname</span><span style="color: #339933;">,</span> <span style="color: #000033;">$numchars</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">32</span><span style="color: #009900;">&#41;</span> <br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used to compare one TEXT (clob) column.</span><br />  <span style="color: #666666; font-style: italic;">/// with one VARCHAR column.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_order_by_text</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$fieldname</span><span style="color: #339933;">,</span> <span style="color: #000033;">$numchars</span><span style="color: #339933;">=</span><span style="color: #cc66cc;">32</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the SQL text to be used to order by one TEXT (clob) column.</span><br />&#160;<br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_concat</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the proper SQL to do CONCAT between the elements passed.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_concat_join</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$separator</span><span style="color: #339933;">=</span><span style="color: #0000ff;">&quot;' '&quot;</span><span style="color: #339933;">,</span> <span style="color: #000033;">$elements</span><span style="color: #339933;">=</span><span style="color: #990000;">array</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the proper SQL to do CONCAT between the elements passed using one separator.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_fullname</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$first</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'firstname'</span><span style="color: #339933;">,</span> <span style="color: #000033;">$last</span><span style="color: #339933;">=</span><span style="color: #0000ff;">'lastname'</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the proper SQL to concatenate $firstname and $lastname.</span><br />&#160;<br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_isempty</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$tablename</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fieldname</span><span style="color: #339933;">,</span> <span style="color: #000033;">$nullablefield</span><span style="color: #339933;">,</span> <span style="color: #000033;">$textfield</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the proper SQL to know if one field is empty.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_isnotempty</span><span style="color: #009900;">&#40;</span><span style="color: #000033;">$tablename</span><span style="color: #339933;">,</span> <span style="color: #000033;">$fieldname</span><span style="color: #339933;">,</span> <span style="color: #000033;">$nullablefield</span><span style="color: #339933;">,</span> <span style="color: #000033;">$textfield</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the proper SQL to know if one field is not empty.</span><br />o <span style="color: #000033;">$DB</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">sql_empty</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><br />  <span style="color: #666666; font-style: italic;">/// Returns the empty string char used by every supported DB.</span></pre>
<h2> <span class="mw-headline" id="See_also">See also</span></h2>
<ul><li> <a href="/dev/Core_APIs" title="Core APIs">Core APIs</a>
</li><li> <a href="/dev/DML_exceptions" title="DML exceptions">DML exceptions</a>: New DML code is throwing exceptions instead of returning false if anything goes wrong
</li><li> <a href="/dev/DML_drivers" title="DML drivers">DML drivers</a>: Database drivers for new DML layer
</li><li> <a href="/dev/DML_functions_-_pre_2.0" title="DML functions - pre 2.0">DML functions - pre 2.0</a>: <b>(deprecated!)</b> For information valid before Moodle 2.0.
</li><li> <a href="/dev/DDL_functions" title="DDL functions" class="mw-redirect">DDL functions</a>: Where all the functions used to handle DB objects (<a href="http://en.wikipedia.org/wiki/Data_Definition_Language" class="extiw" title="wikipedia:Data Definition Language">DDL</a>) are defined.
</li><li> <a href="/dev/DB_layer_2.0_examples" title="DB layer 2.0 examples">DB layer 2.0 examples</a>: To see some code examples using various DML functions.
</li><li> <a href="/dev/DB_layer_2.0_migration_docs" title="DB layer 2.0 migration docs">DB layer 2.0 migration docs</a>: Information about how to modify your code to work with the new Moodle 2.0 DB layer.
</li><li> <a href="/dev/DTL_functions" title="DTL functions">DTL functions</a>: Exporting, importing and moving of data stored in SQL databases
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 433/1000000
Post-expand include size: 140/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key docs_development:pcache:idhash:478-0!*!0!!en!*!edit=0 and timestamp 20120405183404 -->
<div class="printfooter">
Retrieved from "<a href="http://docs.moodle.org/dev/Data_manipulation_API">http://docs.moodle.org/dev/Data_manipulation_API</a>"</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/dev/Special:Categories" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="/dev/Category:Moodle_2.0" title="Category:Moodle 2.0">Moodle 2.0</a></span> | <span dir='ltr'><a href="/dev/Category:DB" title="Category:DB">DB</a></span> | <span dir='ltr'><a href="/dev/Category:XMLDB" title="Category:XMLDB">XMLDB</a></span> | <span dir='ltr'><a href="/dev/Category:API" title="Category:API">API</a></span></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				 <li id="ca-nstab-main" class="selected"><span class="tab"><a href="/dev/Data_manipulation_API" title="View the content page [c]" accesskey="c">Page</a></span></li>
				 <li id="ca-talk"><span class="tab"><a href="/dev/Talk:Data_manipulation_API" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
				 <li id="ca-edit"><span class="tab"><a href="/dev/index.php?title=Special:UserLogin&amp;returnto=Data_manipulation_API" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></span></li>
				 <li id="ca-viewsource"><span class="tab"><a href="/dev/index.php?title=Data_manipulation_API&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
				 <li id="ca-history"><span class="tab"><a href="/dev/index.php?title=Data_manipulation_API&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></span></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/dev/index.php?title=Special:UserLogin&amp;returnto=Data manipulation API" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/prodwiki/skins/moodledocsnew/images/version.dev.png);" href="/dev/Main_Page" title="Visit the main page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/dev/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-recentchanges"><a href="/dev/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/dev/Special:WhatLinksHere/Data_manipulation_API" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/dev/Special:RecentChangesLinked/Data_manipulation_API" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="/dev/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/dev/index.php?title=Data_manipulation_API&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/dev/index.php?title=Data_manipulation_API&amp;oldid=32982" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-User_docs_.28English.29'>
		<h5>User docs (English)</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Moodle-Docs-2.2"><a href="http://docs.moodle.org/22/en">Moodle Docs 2.2</a></li>
				<li id="n-Moodle-Docs-2.1"><a href="http://docs.moodle.org/21/en">Moodle Docs 2.1</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/dev/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" title="Search MoodleDocs" accesskey="f" type="search" name="search" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&#160;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</form>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="/dev/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 27 March 2012, at 10:06.</li>
		<li id="copyright">Content is available under <a href="http://docs.moodle.org/en/License" class="external ">GNU Public License</a>.</li>
		<li id="privacy"><a href="/dev/MoodleDocs:Privacy_policy" title="MoodleDocs:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="/dev/MoodleDocs:About" title="MoodleDocs:About">About MoodleDocs</a></li>
		<li id="disclaimer"><a href="/dev/MoodleDocs:General_disclaimer" title="MoodleDocs:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>

<script src="/dev/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=moodledocsnew&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Data_manipulation_API", "wgTitle": "Data manipulation API", "wgAction": "view", "wgArticleId": 478, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 32982, "wgCategories": ["Moodle 2.0", "DB", "XMLDB", "API"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"moodledocsnew","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":
	0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script><!-- Served in 0.036 secs. -->
<!-- final footer start -->
<div id="moodlesitelink"><a href="http://moodle.org/"><img class="logo" src="/dev/skins/moodledocsnew/images/moodle-logo-footer.gif" alt="moodlelogo" title="Return to Moodle.org" /></a></div>
<!-- final footer end -->

</div><!-- #page -->
<!-- google analytics start -->
<script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-72764-4");pageTracker._trackPageview();} catch(err) {}</script>
<!-- google analytics end -->

</body></html>